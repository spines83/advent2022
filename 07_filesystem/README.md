Ended up going with an iterative solution here that makes a bunch of assumptions.

Would probably opt for a class-based approach w/ recursion and have a little more fine-grained control over the file iterator if we were doing this for real. 